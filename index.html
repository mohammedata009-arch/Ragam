<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>ØªØ·Ø¨ÙŠÙ‚ Ù…Ø­Ù…Ø¯ Ø·Ù‡ - Ù…ÙˆÙ„Ø¯ Ø§Ù„Ø£Ø³Ù…Ø§Ø¡ Ø§Ù„Ø°ÙƒÙŠ</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        body { font-family: sans-serif; padding: 20px; background: #f0f2f5; text-align: center; }
        .container { background: white; padding: 25px; border-radius: 15px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); max-width: 500px; margin: auto; }
        h2 { color: #075e54; margin-bottom: 5px; }
        .dev-name { color: #555; font-size: 14px; margin-bottom: 20px; }
        input, select { padding: 12px; margin: 10px 0; width: 95%; border-radius: 8px; border: 1px solid #ccc; font-size: 16px; box-sizing: border-box; }
        .btn-group { display: flex; flex-wrap: wrap; justify-content: space-between; }
        button { padding: 15px; margin: 5px 0; width: 48%; border-radius: 8px; border: none; cursor: pointer; font-weight: bold; color: white; font-size: 14px; }
        .btn-gen { background: #25D366; width: 100%; margin-bottom: 10px; }
        .btn-vcf { background: #007bff; width: 100%; }
        .btn-excel { background: #1D6F42; }
        .btn-copy { background: #333; }
        table { width: 100%; margin-top: 20px; border-collapse: collapse; }
        th, td { border: 1px solid #ddd; padding: 10px; text-align: center; }
        th { background: #075e54; color: white; }
        .wa-link { color: #25D366; font-weight: bold; text-decoration: none; }
    </style>
</head>
<body>

<div class="container">
    <h2>Ù…ÙˆÙ„Ø¯ Ø£Ø±Ù‚Ø§Ù… Ø§Ù„Ø³ÙˆØ¯Ø§Ù† ğŸ‡¸ğŸ‡©</h2>
    <div class="dev-name">Ø§Ù„Ù…Ø·ÙˆØ±: Ù…Ø­Ù…Ø¯ Ø·Ù‡ Ø¹Ø·Ø§ Ø§Ù„Ù…Ù†Ø§Ù†</div>
    
    <select id="network">
        <option value="+24991">Ø²ÙŠÙ† Ø§Ù„Ø³ÙˆØ¯Ø§Ù† (91)</option>
        <option value="+24912">Ø³ÙˆØ¯Ø§Ù†ÙŠ (12)</option>
        <option value="+24992">Ø£Ø±ÙˆÙŠØ¯Ùˆ (92)</option>
    </select>

    <input type="text" id="contactName" placeholder="Ø§ÙƒØªØ¨ Ø§Ù„Ø§Ø³Ù… Ù‡Ù†Ø§ (Ù…Ø«Ù„Ø§Ù‹: Ø²Ø¨ÙˆÙ†)">
    <input type="number" id="count" placeholder="ÙƒÙ… Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ø±Ù‚Ø§Ù… Ø§Ù„Ù…Ø±Ø§Ø¯ ØªÙˆÙ„ÙŠØ¯Ù‡Ø§ØŸ">
    
    <button class="btn-gen" onclick="generateNumbers()">1. ØªÙˆÙ„ÙŠØ¯ Ø§Ù„Ø£Ø±Ù‚Ø§Ù…</button>
    
    <div class="btn-group">
        <button class="btn-excel" onclick="exportToExcel()">ØªØ­Ù…ÙŠÙ„ Excel</button>
        <button class="btn-copy" onclick="copyNumbers()">Ù†Ø³Ø® Ø§Ù„Ø£Ø±Ù‚Ø§Ù…</button>
    </div>
    
    <button class="btn-vcf" onclick="exportToVCF()">2. ØªØ­Ù…ÙŠÙ„ Ù…Ù„Ù Ø§Ù„Ø£Ø³Ù…Ø§Ø¡ (VCF) Ù„Ù„Ù‡Ø§ØªÙ</button>

    <div id="tableContainer"></div>
</div>

<script>
    let currentNumbers = [];

    function generateNumbers() {
        const prefix = document.getElementById('network').value;
        const count = document.getElementById('count').value;
        const container = document.getElementById('tableContainer');
        
        if (!count || count <= 0) { alert("Ø§Ù„Ø±Ø¬Ø§Ø¡ ØªØ­Ø¯ÙŠØ¯ Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ø±Ù‚Ø§Ù…"); return; }
        
        currentNumbers = [];
        let html = "<table><tr><th>Ø§Ù„Ø±Ù‚Ù…</th><th>Ø§Ø®ØªØ¨Ø§Ø±</th></tr>";

        for (let i = 0; i < count; i++) {
            const num = prefix + Math.floor(1000000 + Math.random() * 8999999);
            currentNumbers.push(num);
            html += `<tr><td>${num}</td><td><a href="https://wa.me/${num}" target="_blank" class="wa-link">Ø¯Ø±Ø¯Ø´Ø©</a></td></tr>`;
        }
        container.innerHTML = html + "</table>";
    }

    function exportToVCF() {
        const baseName = document.getElementById('contactName').value || "Ø³ÙˆØ¯Ø§Ù†ÙŠ";
        if (currentNumbers.length === 0) { alert("ÙŠØ¬Ø¨ ØªÙˆÙ„ÙŠØ¯ Ø§Ù„Ø£Ø±Ù‚Ø§Ù… Ø£ÙˆÙ„Ø§Ù‹"); return; }
        
        let vcfContent = "";
        currentNumbers.forEach((num, index) => {
            // Ù‡Ù†Ø§ ÙŠØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø°ÙŠ Ø§Ø®ØªØ±ØªÙ‡ Ù…Ø¹ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„ØªØ³Ù„Ø³Ù„ÙŠ
            vcfContent += `BEGIN:VCARD\nVERSION:3.0\nFN:${baseName} ${index + 1}\nTEL;TYPE=CELL:${num}\nEND:VCARD\n`;
        });
        
        const blob = new Blob([vcfContent], { type: "text/vcard" });
        const url = window.URL.createObjectURL(blob);
        const a = document.createElement("a");
        a.href = url;
        a.download = `${baseName}_contacts.vcf`;
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
    }

    function exportToExcel() {
        if (currentNumbers.length === 0) return alert("ÙˆÙ„Ø¯ Ø§Ù„Ø£Ø±Ù‚Ø§Ù… Ø£ÙˆÙ„Ø§Ù‹");
        const data = currentNumbers.map(n => ({ "Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ": n }));
        const ws = XLSX.utils.json_to_sheet(data);
        const wb = XLSX.utils.book_new();
        XLSX.utils.book_append_sheet(wb, ws, "Numbers");
        XLSX.writeFile(wb, "Sudan_Numbers.xlsx");
    }

    function copyNumbers() {
        if (currentNumbers.length === 0) return;
        navigator.clipboard.writeText(currentNumbers.join("\n"));
        alert("ØªÙ… Ù†Ø³Ø® Ø§Ù„Ø£Ø±Ù‚Ø§Ù…");
    }
</script>
</body>
</html>
