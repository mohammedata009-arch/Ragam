<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>ØªØ·Ø¨ÙŠÙ‚ Ù…Ø­Ù…Ø¯ Ø·Ù‡ - Ù…ÙˆÙ„Ø¯ Ø£Ø±Ù‚Ø§Ù… VCF</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        body { font-family: sans-serif; padding: 20px; background: #e5ddd5; text-align: center; }
        .container { background: white; padding: 30px; border-radius: 15px; box-shadow: 0 4px 15px rgba(0,0,0,0.2); max-width: 600px; margin: auto; }
        button { padding: 12px; margin: 5px; width: 45%; border-radius: 8px; border: none; cursor: pointer; font-weight: bold; color: white; }
        .btn-vcf { background: #007bff; width: 93%; }
        .btn-gen { background: #25D366; }
        .btn-excel { background: #1D6F42; }
        input, select { padding: 12px; margin: 10px; width: 90%; border-radius: 8px; border: 1px solid #ccc; }
        table { width: 100%; margin-top: 20px; border-collapse: collapse; }
        th, td { border: 1px solid #ddd; padding: 8px; }
    </style>
</head>
<body>

<div class="container">
    <h2>Ù…ÙˆÙ„Ø¯ Ø£Ø±Ù‚Ø§Ù… Ø§Ù„Ø³ÙˆØ¯Ø§Ù† (VCF) ğŸ‡¸ğŸ‡©</h2>
    <p>Ø¨ÙˆØ§Ø³Ø·Ø©: Ù…Ø­Ù…Ø¯ Ø·Ù‡ Ø¹Ø·Ø§ Ø§Ù„Ù…Ù†Ø§Ù†</p>
    
    <select id="network">
        <option value="+24991">Ø²ÙŠÙ† (91)</option>
        <option value="+24912">Ø³ÙˆØ¯Ø§Ù†ÙŠ (12)</option>
        <option value="+24992">Ø£Ø±ÙˆÙŠØ¯Ùˆ (92)</option>
    </select>

    <input type="number" id="count" placeholder="ÙƒÙ… Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ø±Ù‚Ø§Ù…ØŸ">
    
    <button class="btn-gen" onclick="generateNumbers()">ØªÙˆÙ„ÙŠØ¯ Ø§Ù„Ø£Ø±Ù‚Ø§Ù…</button>
    <button class="btn-excel" onclick="exportToExcel()">Ù…Ù„Ù Excel</button>
    <button class="btn-vcf" onclick="exportToVCF()">ØªØ­Ù…ÙŠÙ„ Ù…Ù„Ù Ø¬Ù‡Ø§Øª Ø§Ù„Ø§ØªØµØ§Ù„ (VCF)</button>

    <div id="tableContainer"></div>
</div>

<script>
    let currentNumbers = [];

    function generateNumbers() {
        const prefix = document.getElementById('network').value;
        const count = document.getElementById('count').value;
        const container = document.getElementById('tableContainer');
        currentNumbers = [];
        let html = "<table><tr><th>Ø§Ù„Ø±Ù‚Ù…</th><th>ÙˆØ§ØªØ³Ø§Ø¨</th></tr>";

        for (let i = 0; i < count; i++) {
            const num = prefix + Math.floor(1000000 + Math.random() * 8999999);
            currentNumbers.push(num);
            html += `<tr><td>${num}</td><td><a href="https://wa.me/${num}">Ø¯Ø±Ø¯Ø´Ø©</a></td></tr>`;
        }
        container.innerHTML = html + "</table>";
    }

    function exportToVCF() {
        if (currentNumbers.length === 0) return alert("ÙˆÙ„Ø¯ Ø§Ù„Ø£Ø±Ù‚Ø§Ù… Ø£ÙˆÙ„Ø§Ù‹");
        let vcfContent = "";
        currentNumbers.forEach((num, index) => {
            vcfContent += `BEGIN:VCARD\nVERSION:3.0\nFN:Ø³ÙˆØ¯Ø§Ù†ÙŠ ${index + 1}\nTEL;TYPE=CELL:${num}\nEND:VCARD\n`;
        });
        
        const blob = new Blob([vcfContent], { type: "text/vcf" });
        const url = window.URL.createObjectURL(blob);
        const a = document.createElement("a");
        a.href = url;
        a.download = "Sudan_Contacts_Taha.vcf";
        a.click();
    }

    function exportToExcel() {
        const data = currentNumbers.map(n => ({ "Ø§Ù„Ø±Ù‚Ù…": n }));
        const ws = XLSX.utils.json_to_sheet(data);
        const wb = XLSX.utils.book_new();
        XLSX.utils.book_append_sheet(wb, ws, "Numbers");
        XLSX.writeFile(workbook, "Sudan_Numbers.xlsx");
    }
</script>
</body>
</html>
